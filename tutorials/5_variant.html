
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Predict Effects of Alzheimer’s Variants Using ATAC Models &#8212; gReLU</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=266695fe" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=4e48d009"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <link rel="canonical" href="https://braid-relu.pages.roche.com/grelu/latest/index.html/tutorials/5_variant.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Querying the public gReLU model zoo on Weights and Biases (wandb)" href="6_model_zoo.html" />
    <link rel="prev" title="Model-guided design of regulatory elements" href="4_design.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Jul 05, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">gReLU</p>
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../readme.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="1_inference.html">
    Tutorial: Inference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="2_finetune.html">
    Tutorial: Fine-tuning
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="3_train.html">
    Tutorial: Training
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="4_design.html">
    Tutorial: Design
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="#">
    Tutorial: Variant effect prediction
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="6_model_zoo.html">
    Tutorial: Model zoo
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../license.html">
    License
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../authors.html">
    Contributors
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../changelog.html">
    Changelog
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../autoapi/index.html">
    API Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Genentech/gReLU" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../readme.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="1_inference.html">
    Tutorial: Inference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="2_finetune.html">
    Tutorial: Fine-tuning
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="3_train.html">
    Tutorial: Training
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="4_design.html">
    Tutorial: Design
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Tutorial: Variant effect prediction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="6_model_zoo.html">
    Tutorial: Model zoo
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../license.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../authors.html">
    Contributors
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../changelog.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Genentech/gReLU" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Predict...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="predict-effects-of-alzheimer-s-variants-using-atac-models">
<h1>Predict Effects of Alzheimer’s Variants Using ATAC Models<a class="headerlink" href="#predict-effects-of-alzheimer-s-variants-using-atac-models" title="Link to this heading">#</a></h1>
<p>In this tutorial, we demonstrate how to predict the impact of sequence variation using a trained gReLU model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">anndata</span> <span class="k">as</span> <span class="nn">ad</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<section id="load-the-catlas-model">
<h2>Load the CATlas model<a class="headerlink" href="#load-the-catlas-model" title="Link to this heading">#</a></h2>
<p>This is a binary classification model trained on snATAC-seq data from Catlas (<a class="reference external" href="http://catlas.org/humanenhancer/">http://catlas.org/humanenhancer/</a>). This model predicts the probability that an input sequence will be accessible in various cell types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grelu.resources</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;human-atac-catlas&#39;</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="view-the-model-s-metadata">
<h2>View the model’s metadata<a class="headerlink" href="#view-the-model-s-metadata" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">model.data_params</span></code> is a dictionary containing metadata about the data used to train the model. Let’s look at what information is stored:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">21</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span><span class="s2">&quot;tasks&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">data_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>train_bin_size 1
train_chroms [&#39;chr18&#39;, &#39;chr5&#39;, &#39;chr1&#39;, &#39;chr17&#39;, &#39;chr9&#39;, &#39;chr19&#39;, &#39;chr8&#39;, &#39;chr21&#39;, &#39;chr14&#39;, &#39;chr20&#39;, &#39;chr22&#39;, &#39;chr10&#39;, &#39;chr15&#39;, &#39;chr12&#39;, &#39;chr16&#39;, &#39;chr3&#39;, &#39;chr4&#39;, &#39;chr11&#39;, &#39;chr2&#39;, &#39;chr6&#39;]
train_end both
train_genome hg38
train_label_aggfunc None
train_label_len 200
train_label_transform_func None
train_max_label_clip None
train_max_pair_shift 0
train_max_seq_shift 1
train_min_label_clip None
train_n_alleles 1
train_n_augmented 1
train_n_seqs 1022128
train_n_tasks 204
train_padded_label_len 200
train_padded_seq_len 202
train_predict False
train_rc True
train_seq_len 200
</pre></div>
</div>
</div>
</div>
<p>Note the parameter <code class="docutils literal notranslate"><span class="pre">train_seq_len</span></code>. This tells us that the model was trained on 200 bp long sequences.</p>
<p><code class="docutils literal notranslate"><span class="pre">model.data_params['tasks']</span></code> is a large dictionary containing metadata about the output tracks that the model predicts. We can collect these into a dataframe called tasks:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tasks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data_params</span><span class="p">[</span><span class="s1">&#39;tasks&#39;</span><span class="p">])</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>cell type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Follicular</td>
      <td>Follicular</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Fibro General</td>
      <td>Fibro General</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Acinar</td>
      <td>Acinar</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="load-alzheimer-s-variants-from-gwas-catalog-jansen-et-al-2019-meta-analysis">
<h2>Load Alzheimer’s Variants from GWAS Catalog (Jansen et al. 2019 meta-analysis)<a class="headerlink" href="#load-alzheimer-s-variants-from-gwas-catalog-jansen-et-al-2019-meta-analysis" title="Link to this heading">#</a></h2>
<p>Download a small subset of variants from the AD sumstats file from this meta-analysis study. This contains 1,000 variants mapped to the hg19 genome.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grelu.resources</span>

<span class="n">variant_dir</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get_artifact</span><span class="p">(</span>
    <span class="n">project</span><span class="o">=</span><span class="s1">&#39;alzheimers-variant-tutorial&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dataset&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>

<span class="n">variant_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">variant_dir</span><span class="p">,</span> <span class="s2">&quot;variants.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variants</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">variant_file</span><span class="p">)</span>
<span class="n">variants</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>snpid</th>
      <th>chrom</th>
      <th>pos</th>
      <th>alt</th>
      <th>ref</th>
      <th>rsid</th>
      <th>zscore</th>
      <th>pval</th>
      <th>nsum</th>
      <th>neff</th>
      <th>direction</th>
      <th>eaf</th>
      <th>beta</th>
      <th>se</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6:32630634_G_A</td>
      <td>chr6</td>
      <td>32630634</td>
      <td>G</td>
      <td>A</td>
      <td>6:32630634</td>
      <td>3.974476</td>
      <td>0.000071</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.2237</td>
      <td>0.025194</td>
      <td>0.006339</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6:32630797_A_G</td>
      <td>chr6</td>
      <td>32630797</td>
      <td>A</td>
      <td>G</td>
      <td>6:32630797</td>
      <td>4.040244</td>
      <td>0.000053</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.2435</td>
      <td>0.024866</td>
      <td>0.006155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6:32630824_T_C</td>
      <td>chr6</td>
      <td>32630824</td>
      <td>T</td>
      <td>C</td>
      <td>6:32630824</td>
      <td>3.921736</td>
      <td>0.000088</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.1859</td>
      <td>0.026630</td>
      <td>0.006790</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="filter-variants">
<h2>Filter variants<a class="headerlink" href="#filter-variants" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grelu.data.preprocess</span> <span class="kn">import</span> <span class="n">filter_blacklist</span><span class="p">,</span> <span class="n">filter_chromosomes</span>
<span class="kn">from</span> <span class="nn">grelu.variant</span> <span class="kn">import</span> <span class="n">filter_variants</span>
</pre></div>
</div>
</div>
</div>
<p>Remove indels, since we don’t support them for now. We also remove variants where one of the alleles contains Ns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variants</span> <span class="o">=</span> <span class="n">filter_variants</span><span class="p">(</span><span class="n">variants</span><span class="p">,</span> <span class="n">max_del_len</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_insert_len</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">standard_bases</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial number of variants: 1000
Final number of variants: 989
</pre></div>
</div>
</div>
</div>
<p>Remove non-standard chromosomes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variants</span> <span class="o">=</span> <span class="n">filter_chromosomes</span><span class="p">(</span><span class="n">variants</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="s1">&#39;autosomesXY&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Keeping 989 intervals
</pre></div>
</div>
</div>
</div>
<p>Remove SNPs from unmappable regions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variants</span> <span class="o">=</span> <span class="n">filter_blacklist</span><span class="p">(</span><span class="n">variants</span><span class="p">,</span> <span class="n">genome</span><span class="o">=</span><span class="s2">&quot;hg19&quot;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Keeping 988 intervals
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variants</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>snpid</th>
      <th>chrom</th>
      <th>pos</th>
      <th>alt</th>
      <th>ref</th>
      <th>rsid</th>
      <th>zscore</th>
      <th>pval</th>
      <th>nsum</th>
      <th>neff</th>
      <th>direction</th>
      <th>eaf</th>
      <th>beta</th>
      <th>se</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6:32630634_G_A</td>
      <td>chr6</td>
      <td>32630634</td>
      <td>G</td>
      <td>A</td>
      <td>6:32630634</td>
      <td>3.974476</td>
      <td>0.000071</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.2237</td>
      <td>0.025194</td>
      <td>0.006339</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6:32630797_A_G</td>
      <td>chr6</td>
      <td>32630797</td>
      <td>A</td>
      <td>G</td>
      <td>6:32630797</td>
      <td>4.040244</td>
      <td>0.000053</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.2435</td>
      <td>0.024866</td>
      <td>0.006155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6:32630824_T_C</td>
      <td>chr6</td>
      <td>32630824</td>
      <td>T</td>
      <td>C</td>
      <td>6:32630824</td>
      <td>3.921736</td>
      <td>0.000088</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.1859</td>
      <td>0.026630</td>
      <td>0.006790</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="predict-variant-effects">
<h2>Predict variant effects<a class="headerlink" href="#predict-variant-effects" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">grelu.variant</span></code> module contains several functions related to analysis of variants. The <code class="docutils literal notranslate"><span class="pre">predict_variant_effects</span></code> function takes a model and a dataframe of variants, and uses the model to predict the activity of the genomic regions containing both the ref and alt alleles. It can then compare the two predictions and return an effect size for each variant. We can also apply data augmentation, i.e. make predictions for several versions of the sequence and average them together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grelu.variant</span>

<span class="n">odds</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">variant</span><span class="o">.</span><span class="n">predict_variant_effects</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="n">variants</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> 
    <span class="n">devices</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># Run on GPU 0</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
    <span class="n">genome</span><span class="o">=</span><span class="s2">&quot;hg19&quot;</span><span class="p">,</span>
    <span class="n">compare_func</span><span class="o">=</span><span class="s2">&quot;log2FC&quot;</span><span class="p">,</span> <span class="c1"># Return the log2 fold change between alt and ref predictions</span>
    <span class="n">return_ad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Return an anndata object.</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># Reverse complement the ref/alt predictions and average them.</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>making dataset
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████| 8/8 [00:01&lt;00:00,  4.78it/s]
</pre></div>
</div>
</div>
</div>
<p>Now this (odds) is an AnnData object (similar to <code class="docutils literal notranslate"><span class="pre">SingleCellExperiment</span></code> in R but in Python). Might be a good point to pause here and learn more about it: <a class="reference external" href="https://anndata.readthedocs.io/en/latest/">https://anndata.readthedocs.io/en/latest/</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AnnData object with n_obs × n_vars = 988 × 204
    obs: &#39;snpid&#39;, &#39;chrom&#39;, &#39;pos&#39;, &#39;alt&#39;, &#39;ref&#39;, &#39;rsid&#39;, &#39;zscore&#39;, &#39;pval&#39;, &#39;nsum&#39;, &#39;neff&#39;, &#39;direction&#39;, &#39;eaf&#39;, &#39;beta&#39;, &#39;se&#39;
    var: &#39;cell type&#39;
</pre></div>
</div>
</div>
</div>
<p>odds.var contains the cell types for which the model makes predictions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cell type</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Follicular</th>
      <td>Follicular</td>
    </tr>
    <tr>
      <th>Fibro General</th>
      <td>Fibro General</td>
    </tr>
    <tr>
      <th>Acinar</th>
      <td>Acinar</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>odds.obs contains the variants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odds</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>snpid</th>
      <th>chrom</th>
      <th>pos</th>
      <th>alt</th>
      <th>ref</th>
      <th>rsid</th>
      <th>zscore</th>
      <th>pval</th>
      <th>nsum</th>
      <th>neff</th>
      <th>direction</th>
      <th>eaf</th>
      <th>beta</th>
      <th>se</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6:32630634_G_A</td>
      <td>chr6</td>
      <td>32630634</td>
      <td>G</td>
      <td>A</td>
      <td>6:32630634</td>
      <td>3.974476</td>
      <td>0.000071</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.2237</td>
      <td>0.025194</td>
      <td>0.006339</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6:32630797_A_G</td>
      <td>chr6</td>
      <td>32630797</td>
      <td>A</td>
      <td>G</td>
      <td>6:32630797</td>
      <td>4.040244</td>
      <td>0.000053</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.2435</td>
      <td>0.024866</td>
      <td>0.006155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6:32630824_T_C</td>
      <td>chr6</td>
      <td>32630824</td>
      <td>T</td>
      <td>C</td>
      <td>6:32630824</td>
      <td>3.921736</td>
      <td>0.000088</td>
      <td>71639</td>
      <td>71639.0</td>
      <td>?+?+</td>
      <td>0.1859</td>
      <td>0.026630</td>
      <td>0.006790</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And odds.X contains the predicted effect size for each variant in a numpy array of shape (n_variants x n_cell types)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">odds</span><span class="o">.</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.5886321   1.2478062   1.2845564   1.868789    1.3667169 ]
 [ 0.06283956  0.11273362  0.17008997  0.2536258   0.35816932]
 [-0.45841014  0.00426316 -0.52971315 -0.37011045 -0.2963973 ]
 [ 0.26240113  0.33035216  0.67170584  0.3984024   0.46165606]
 [-1.0053136  -0.6806445  -0.08496638  0.3818305   0.03284647]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-a-variant-with-effect-specific-to-microglia">
<h2>Select a variant with effect specific to microglia<a class="headerlink" href="#select-a-variant-with-effect-specific-to-microglia" title="Link to this heading">#</a></h2>
<p>As an example, we search for variants that strongly disrupt accessibility in microglia but not in all cell types.</p>
<p>We set some arbitrary thresholds; The log2 fold change of the alt allele w.r.t the ref allele should be &lt; -2, and the average log2 fold change of the alt allele w.r.t the ref allele should be nonnegative.</p>
<p>This implies that the alt allele should decrease accessibility in microglia to &lt; 1/4 of its reference value, but should not decrease accessibility across all cell types on average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean variant effect across all cell types</span>
<span class="n">mean_variant_effect</span> <span class="o">=</span> <span class="n">odds</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the variant effect only in microglia</span>
<span class="n">microglia_effect</span> <span class="o">=</span> <span class="n">odds</span><span class="p">[:,</span> <span class="s1">&#39;Microglia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specific_variant_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">microglia_effect</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mean_variant_effect</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> 
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">specific_variant_idx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([498])
</pre></div>
</div>
</div>
</div>
<p>We will isolate this microglia specific variant to analyze further.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variant</span> <span class="o">=</span> <span class="n">odds</span><span class="p">[</span><span class="n">specific_variant_idx</span><span class="p">,</span> <span class="p">:]</span> 
<span class="n">variant</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>View of AnnData object with n_obs × n_vars = 1 × 204
    obs: &#39;snpid&#39;, &#39;chrom&#39;, &#39;pos&#39;, &#39;alt&#39;, &#39;ref&#39;, &#39;rsid&#39;, &#39;zscore&#39;, &#39;pval&#39;, &#39;nsum&#39;, &#39;neff&#39;, &#39;direction&#39;, &#39;eaf&#39;, &#39;beta&#39;, &#39;se&#39;
    var: &#39;cell type&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variant</span><span class="o">.</span><span class="n">obs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>snpid</th>
      <th>chrom</th>
      <th>pos</th>
      <th>alt</th>
      <th>ref</th>
      <th>rsid</th>
      <th>zscore</th>
      <th>pval</th>
      <th>nsum</th>
      <th>neff</th>
      <th>direction</th>
      <th>eaf</th>
      <th>beta</th>
      <th>se</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>498</th>
      <td>6:76659840_T_G</td>
      <td>chr6</td>
      <td>76659840</td>
      <td>T</td>
      <td>G</td>
      <td>rs138940043</td>
      <td>4.009219</td>
      <td>0.000061</td>
      <td>363637</td>
      <td>363637.0</td>
      <td>??+?</td>
      <td>0.00656</td>
      <td>0.058235</td>
      <td>0.014525</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s look at the effect size (log2FC) for this variant:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variant_effect_size</span> <span class="o">=</span> <span class="n">variant</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Microglia&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">X</span>
<span class="n">variant_effect_size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ArrayView([[-2.5063705]], dtype=float32)
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-importance-scores-in-microglia-for-the-bases-surrounding-the-selected-variant">
<h2>View importance scores in microglia for the bases surrounding the selected variant<a class="headerlink" href="#view-importance-scores-in-microglia-for-the-bases-surrounding-the-selected-variant" title="Link to this heading">#</a></h2>
<p>We can use several different approaches to calculate the importance of each base in the reference and alternate sequence. However, we want to score each base specifically by its importance to the model’s prediction in microglia and not the model’s predictions on other tasks.</p>
<p>To do this we define a transform that operates on the model’s predictions and selects only the predictions in Microglia.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grelu.transforms.prediction_transforms</span> <span class="kn">import</span> <span class="n">Aggregate</span>
<span class="n">microglia_score</span> <span class="o">=</span> <span class="n">Aggregate</span><span class="p">(</span><span class="n">tasks</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Microglia&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we extract the 200 bp long genomic sequences containing the reference and alternate alleles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_seq</span><span class="p">,</span> <span class="n">alt_seq</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">variant</span><span class="o">.</span><span class="n">variant_to_seqs</span><span class="p">(</span>
    <span class="n">seq_len</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">data_params</span><span class="p">[</span><span class="s1">&#39;train_seq_len&#39;</span><span class="p">],</span>
    <span class="n">genome</span><span class="o">=</span><span class="s1">&#39;hg19&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">variant</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][[</span><span class="s2">&quot;chrom&quot;</span><span class="p">,</span> <span class="s2">&quot;pos&quot;</span><span class="p">,</span> <span class="s2">&quot;ref&quot;</span><span class="p">,</span> <span class="s2">&quot;alt&quot;</span><span class="p">]]</span>
<span class="p">)</span>

<span class="n">ref_seq</span><span class="p">,</span> <span class="n">alt_seq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;CAAAGATATATGTCATAATAATTATCTTTTCACTTTCTTTGTTAGGGACCAGGAATGATAAACCACTTAGTCATTTTTTAGGTTTACAAGAACTTAAGGGGAACTAAGAAAGGAACCCTTACTCCTGAACTCTCAGCCTCATCTGTGCTGGACCATTCTAACTTTGTACCCTTTCATGAGATTGATATAATTTAGAAAAT&#39;,
 &#39;CAAAGATATATGTCATAATAATTATCTTTTCACTTTCTTTGTTAGGGACCAGGAATGATAAACCACTTAGTCATTTTTTAGGTTTACAAGAACTTAAGGTGAACTAAGAAAGGAACCCTTACTCCTGAACTCTCAGCCTCATCTGTGCTGGACCATTCTAACTTTGTACCCTTTCATGAGATTGATATAATTTAGAAAAT&#39;)
</pre></div>
</div>
</div>
</div>
<p>We are now ready to calculate the per-base importance scores. For this, we use the <code class="docutils literal notranslate"><span class="pre">grelu.interpret.score</span></code> module, which contains functions related to scoring the importance of each base in a sequence. We choose the “inputxgradient” method to score each base.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grelu.interpret.score</span>

<span class="n">ref_attrs</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">interpret</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">get_attributions</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">ref_seq</span><span class="p">,</span> <span class="n">prediction_transform</span><span class="o">=</span><span class="n">microglia_score</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;inputxgradient&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">alt_attrs</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">interpret</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">get_attributions</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">alt_seq</span><span class="p">,</span> <span class="n">prediction_transform</span><span class="o">=</span><span class="n">microglia_score</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;inputxgradient&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>We can visualize the attribution scores for the sequence, highlighting the mutated base. Here, we visualize the attributions for the central 100 bp of the 200 bp sequence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grelu.visualize</span>
<span class="n">grelu</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_attributions</span><span class="p">(</span>
    <span class="n">ref_attrs</span><span class="p">,</span> <span class="n">start_pos</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">end_pos</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
    <span class="n">highlight_positions</span><span class="o">=</span><span class="p">[</span><span class="mi">99</span><span class="p">],</span> <span class="n">ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;logomaker.src.Logo.Logo at 0x7f8a721e2110&gt;
</pre></div>
</div>
<img alt="../_images/64c3d999ee137c6a035dcff1dfd3da04ad5eab23c44da6e9697cb9ee6963f13d.png" src="../_images/64c3d999ee137c6a035dcff1dfd3da04ad5eab23c44da6e9697cb9ee6963f13d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grelu</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_attributions</span><span class="p">(</span>
    <span class="n">alt_attrs</span><span class="p">,</span> <span class="n">start_pos</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">end_pos</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
    <span class="n">highlight_positions</span><span class="o">=</span><span class="p">[</span><span class="mi">99</span><span class="p">],</span> <span class="n">ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;logomaker.src.Logo.Logo at 0x7f8a34129c50&gt;
</pre></div>
</div>
<img alt="../_images/0ad39a534cc77fc504285deb3f6b56f9fa98b9eb02fddb4593919e011f1933b2.png" src="../_images/0ad39a534cc77fc504285deb3f6b56f9fa98b9eb02fddb4593919e011f1933b2.png" />
</div>
</div>
</section>
<section id="ism">
<h2>ISM<a class="headerlink" href="#ism" title="Link to this heading">#</a></h2>
<p>We can also perform ISM (In silico mutagenesis) of the bases surrounding the variant to see what the effect would be if we mutated the reference allele to any other base. The <code class="docutils literal notranslate"><span class="pre">ISM_predict</span></code> function in <code class="docutils literal notranslate"><span class="pre">grelu.interpret.score</span></code> performs every possible single-base substitution on the given sequence, predicts the effect of each substitution, and optionally compares these predictions to the reference sequence to return an effect size for each substitution.</p>
<p>Once again, since we are interested in how important each base is to the model’s prediction in microglia,
we use the <code class="docutils literal notranslate"><span class="pre">microglia_score</span></code> transform. This ensures that ISM will score each base’s importance to the
microglial prediction only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ism</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">interpret</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">ISM_predict</span><span class="p">(</span>
    <span class="n">ref_seq</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">prediction_transform</span><span class="o">=</span><span class="n">microglia_score</span><span class="p">,</span> <span class="c1"># Focus on the prediction in microglia</span>
    <span class="n">compare_func</span> <span class="o">=</span> <span class="s2">&quot;log2FC&quot;</span><span class="p">,</span> <span class="c1"># Return the log2FC of the mutated sequence prediction w.r.t the reference sequence</span>
    <span class="n">devices</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># Index of the GPU to use</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predicting DataLoader 0: 100%|██████████████████████████████████████████████████████████| 13/13 [00:00&lt;00:00, 26.28it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ism</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>A</th>
      <th>A</th>
      <th>A</th>
      <th>G</th>
      <th>A</th>
      <th>T</th>
      <th>A</th>
      <th>T</th>
      <th>A</th>
      <th>...</th>
      <th>T</th>
      <th>T</th>
      <th>T</th>
      <th>A</th>
      <th>G</th>
      <th>A</th>
      <th>A</th>
      <th>A</th>
      <th>A</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0.035059</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.175448</td>
      <td>0.000000</td>
      <td>0.068264</td>
      <td>0.000000</td>
      <td>0.279259</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.055060</td>
      <td>0.271744</td>
      <td>-0.123421</td>
      <td>-0.000112</td>
      <td>0.096319</td>
      <td>-0.000112</td>
      <td>-0.000112</td>
      <td>-0.000112</td>
      <td>-0.000112</td>
      <td>0.025718</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.000000</td>
      <td>0.033303</td>
      <td>0.094729</td>
      <td>0.088286</td>
      <td>0.242377</td>
      <td>0.156310</td>
      <td>0.097453</td>
      <td>0.381278</td>
      <td>0.206919</td>
      <td>0.283350</td>
      <td>...</td>
      <td>0.102014</td>
      <td>-0.033543</td>
      <td>-0.023884</td>
      <td>0.074331</td>
      <td>-0.127204</td>
      <td>0.100797</td>
      <td>-0.022535</td>
      <td>0.024198</td>
      <td>0.077191</td>
      <td>0.031655</td>
    </tr>
    <tr>
      <th>G</th>
      <td>-0.043938</td>
      <td>0.027918</td>
      <td>0.074443</td>
      <td>0.077228</td>
      <td>0.000000</td>
      <td>0.046280</td>
      <td>0.066102</td>
      <td>0.355099</td>
      <td>0.204960</td>
      <td>-0.027415</td>
      <td>...</td>
      <td>0.012160</td>
      <td>-0.067337</td>
      <td>-0.113562</td>
      <td>-0.052966</td>
      <td>-0.000112</td>
      <td>0.149694</td>
      <td>-0.022391</td>
      <td>0.045327</td>
      <td>-0.012053</td>
      <td>0.024655</td>
    </tr>
    <tr>
      <th>T</th>
      <td>0.059993</td>
      <td>0.051857</td>
      <td>0.068118</td>
      <td>-0.242041</td>
      <td>0.206191</td>
      <td>0.037834</td>
      <td>0.000000</td>
      <td>-0.063626</td>
      <td>0.000000</td>
      <td>0.225319</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000112</td>
      <td>-0.032892</td>
      <td>0.082135</td>
      <td>-0.003328</td>
      <td>-0.192516</td>
      <td>0.036364</td>
      <td>-0.064144</td>
      <td>-0.000112</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 200 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grelu</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_ISM</span><span class="p">(</span>
    <span class="n">ism</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;heatmap&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/cd960b73bdd2601bfa0f4228421f8e357f0ad56480689d4373b7c71d074de483.png" src="../_images/cd960b73bdd2601bfa0f4228421f8e357f0ad56480689d4373b7c71d074de483.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grelu</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_ISM</span><span class="p">(</span>
    <span class="n">ism</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;logo&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">highlight_positions</span><span class="o">=</span><span class="p">[</span><span class="mi">99</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;logomaker.src.Logo.Logo at 0x7f8a2dece810&gt;
</pre></div>
</div>
<img alt="../_images/41204f3bc7080a4dca382294e626ec2abdab211b82a5cd570704b2138c3e3ea7.png" src="../_images/41204f3bc7080a4dca382294e626ec2abdab211b82a5cd570704b2138c3e3ea7.png" />
</div>
</div>
</section>
<section id="scan-variant-with-jaspar-consensus-motifs">
<h2>Scan variant with JASPAR consensus motifs<a class="headerlink" href="#scan-variant-with-jaspar-consensus-motifs" title="Link to this heading">#</a></h2>
<p>We now scan the sequences immediately around the variant to identify known TF motifs that may have been disrupted by the variant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the central bases of the sequence</span>
<span class="n">central_ref_seq</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">ref_seq</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">central_alt_seq</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">alt_seq</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">central_ref_seq</span><span class="p">,</span> <span class="n">central_alt_seq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ACTTAAGGGGAACTAAGA&#39;, &#39;ACTTAAGGTGAACTAAGA&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">grelu.interpret.motifs</span></code> module to scan these sequences with TF motifs. Here, we use a reference set of non-redundant motifs (<a class="reference external" href="https://www.vierstra.org/resources/motif_clustering">https://www.vierstra.org/resources/motif_clustering</a>) that are provided with gReLU as <code class="docutils literal notranslate"><span class="pre">consensus</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scan with motifs</span>
<span class="kn">import</span> <span class="nn">grelu.interpret.motifs</span>

<span class="n">scan</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">interpret</span><span class="o">.</span><span class="n">motifs</span><span class="o">.</span><span class="n">compare_motifs</span><span class="p">(</span>
    <span class="n">ref_seq</span><span class="o">=</span><span class="n">central_ref_seq</span><span class="p">,</span>
    <span class="n">alt_seq</span><span class="o">=</span><span class="n">central_alt_seq</span><span class="p">,</span>
    <span class="n">motifs</span><span class="o">=</span><span class="s2">&quot;consensus&quot;</span><span class="p">,</span>
    <span class="n">pthresh</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">scan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Read 637 motifs from file.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sequence</th>
      <th>motif</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>alt</th>
      <th>ref</th>
      <th>foldChange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AC0176:MZF:C2H2_ZF</td>
      <td>13</td>
      <td>6</td>
      <td>-</td>
      <td>0.000000</td>
      <td>9.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AC0177:ZNF_MZF:C2H2_ZF</td>
      <td>16</td>
      <td>5</td>
      <td>-</td>
      <td>0.000000</td>
      <td>8.431193</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AC0227:SPI_BCL11A:Ets</td>
      <td>5</td>
      <td>16</td>
      <td>+</td>
      <td>0.000000</td>
      <td>11.954545</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AC0622:ELF_SPIB:Ets</td>
      <td>5</td>
      <td>14</td>
      <td>+</td>
      <td>0.000000</td>
      <td>8.308943</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AC0079:ZNF:C2H2_ZF</td>
      <td>14</td>
      <td>1</td>
      <td>-</td>
      <td>1.918367</td>
      <td>0.000000</td>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The ref column contains the score for the motif in the reference allele-cintaining sequence and the alt column contains the score in the alternate-allele containing sequence.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">AC0622:ELF_SPIB:Ets</span></code> motif is lost in the alternate allele-containing sequence.</p>
</section>
<section id="compare-the-variant-impact-to-a-background-distribution">
<h2>Compare the variant impact to a background distribution<a class="headerlink" href="#compare-the-variant-impact-to-a-background-distribution" title="Link to this heading">#</a></h2>
<p>We saw that the variant has a strong effect size (log2 fold change). To place this effect size in context, we create a set of background sequences by shuffling the sequence surrounding the variant while conserving dinucleotide frequency. We then insert the reference and alternate alleles in each shuffled sequence, and compute the variant effect size again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">grelu</span><span class="o">.</span><span class="n">variant</span><span class="o">.</span><span class="n">marginalize_variants</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">variants</span><span class="o">=</span><span class="n">variant</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span>
    <span class="n">genome</span><span class="o">=</span><span class="s2">&quot;hg19&quot;</span><span class="p">,</span>
    <span class="n">prediction_transform</span><span class="o">=</span><span class="n">microglia_score</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">n_shuffles</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">compare_func</span><span class="o">=</span><span class="s2">&quot;log2FC&quot;</span><span class="p">,</span>
    <span class="n">rc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Average the result over both strands</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predicting variant effects
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████| 1/1 [00:02&lt;00:00,  0.48it/s]
Predicting variant effects in background sequences
Predicting DataLoader 0: 100%|████████████████████████████████████████████████████████████| 4/4 [00:12&lt;00:00,  0.33it/s]
Calculating background distributions
Performing 2-sided test
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;effect_size&#39;: [-2.504143476486206],
 &#39;mean&#39;: [-0.08852208405733109],
 &#39;sd&#39;: [0.4351801872253418],
 &#39;pvalue&#39;: [2.8427864717814608e-08]}
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4_design.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Model-guided design of regulatory elements</p>
      </div>
    </a>
    <a class="right-next"
       href="6_model_zoo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Querying the public gReLU model zoo on Weights and Biases (wandb)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-catlas-model">Load the CATlas model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-model-s-metadata">View the model’s metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-alzheimer-s-variants-from-gwas-catalog-jansen-et-al-2019-meta-analysis">Load Alzheimer’s Variants from GWAS Catalog (Jansen et al. 2019 meta-analysis)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-variants">Filter variants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-variant-effects">Predict variant effects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-a-variant-with-effect-specific-to-microglia">Select a variant with effect specific to microglia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-importance-scores-in-microglia-for-the-bases-surrounding-the-selected-variant">View importance scores in microglia for the bases surrounding the selected variant</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ism">ISM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scan-variant-with-jaspar-consensus-motifs">Scan variant with JASPAR consensus motifs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-variant-impact-to-a-background-distribution">Compare the variant impact to a background distribution</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/Genentech/gReLU/edit/main/docs/tutorials/5_variant.ipynb">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorials/5_variant.ipynb">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Regulatory Genomics, BRAID, Genentech.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>